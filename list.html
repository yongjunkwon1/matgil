<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ì› ë§›ì§‘ - ì„ íƒëœ ì§€ì—­</title>
    <style>
        body { font-family: 'Arial', sans-serif; text-align: center; padding: 20px; background-color: #f4f4f4; color: #333; }
        h1 { color: #333; margin-bottom: 10px; }
        h2 { color: #555; margin-bottom: 20px; }
        
        /* ê²€ìƒ‰ ë° í•„í„° ì»¨í…Œì´ë„ˆ */
        .search-filter-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .search-container input {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }
        
        .search-container button {
            padding: 12px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        
        .search-container button:hover {
            background-color: #0056b3;
        }
        
        .filter-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-group label {
            font-weight: bold;
            color: #555;
        }
        
        .filter-group select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9em;
        }
        
        .clear-filters {
            padding: 8px 15px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .clear-filters:hover {
            background-color: #5a6268;
        }
        
        /* ê²°ê³¼ ì •ë³´ */
        .results-info {
            text-align: center;
            margin-bottom: 20px;
            color: #666;
            font-size: 0.95em;
        }

        #map { width: 100%; height: 400px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            justify-content: center;
            padding: 0 20px;
        }
        
        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            background-color: #fff;
            text-align: left;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: transform 0.2s ease-in-out;
            position: relative;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h3 { 
            margin-top: 0; 
            margin-bottom: 10px; 
            color: #007bff; 
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .card h3 a { 
            text-decoration: none; 
            color: #007bff; 
            flex: 1;
        }
        
        .card h3 a:hover { text-decoration: underline; }
        
        .card p { margin-bottom: 8px; line-height: 1.5; font-size: 0.95em; }
        .card strong { color: #555; }
        
        .card .menu-summary {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        /* ë³„ì  í‘œì‹œ */
        .card-rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }
        
        .stars {
            color: #ffc107;
            font-size: 16px;
        }
        
        /* ì¦ê²¨ì°¾ê¸° ë²„íŠ¼ */
        .favorite-btn {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            transition: transform 0.2s;
            margin-left: 10px;
        }
        
        .favorite-btn:hover {
            transform: scale(1.2);
        }
        
        .favorite-btn.active {
            color: #ff6b6b;
        }
        
        /* ìŒì‹ ì¢…ë¥˜ íƒœê·¸ */
        .food-type-tag {
            display: inline-block;
            background-color: #e9ecef;
            color: #495057;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-top: 8px;
        }
        
        .no-restaurant {
            margin-top: 40px;
            font-size: 1.2em;
            color: #777;
        }
        
        /* Custom Overlay ìŠ¤íƒ€ì¼ */
        .label {
            padding: 4px 8px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            white-space: nowrap;
        }
        
        /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
            font-size: 1.1em;
            color: #666;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .search-container {
                flex-direction: column;
            }
            
            .search-container input {
                min-width: auto;
            }
            
            .filter-container {
                flex-direction: column;
                gap: 10px;
            }
            
            .card-container {
                grid-template-columns: 1fr;
                padding: 0 10px;
            }
            
            #map {
                height: 300px;
            }
        }

        /* ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>

    <h1>ìˆ˜ì› ë§›ì§‘ ê°€ì´ë“œ</h1>
    <h2 id="selectedRegion"></h2>

    <!-- ê²€ìƒ‰ ë° í•„í„° ì„¹ì…˜ -->
    <div class="search-filter-container">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="ë§›ì§‘ ì´ë¦„ì´ë‚˜ ë©”ë‰´ë¡œ ê²€ìƒ‰í•˜ì„¸ìš”..." />
            <button onclick="searchRestaurants()" aria-label="ê²€ìƒ‰">ğŸ” ê²€ìƒ‰</button>
        </div>
        
        <div class="filter-container">
            <div class="filter-group">
                <label for="foodTypeFilter">ìŒì‹ ì¢…ë¥˜:</label>
                <select id="foodTypeFilter" onchange="applyFilters()">
                    <option value="">ì „ì²´</option>
                    <option value="í•œì‹">í•œì‹</option>
                    <option value="ì¤‘ì‹">ì¤‘ì‹</option>
                    <option value="ì¼ì‹">ì¼ì‹</option>
                    <option value="ì–‘ì‹">ì–‘ì‹</option>
                    <option value="ë¶„ì‹">ë¶„ì‹</option>
                    <option value="ì¹´í˜">ì¹´í˜Â·ë””ì €íŠ¸</option>
                    <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="ratingFilter">í‰ì :</label>
                <select id="ratingFilter" onchange="applyFilters()">
                    <option value="">ì „ì²´</option>
                    <option value="5">5ì  ì´ìƒ</option>
                    <option value="4">4ì  ì´ìƒ</option>
                    <option value="3">3ì  ì´ìƒ</option>
                    <option value="2">2ì  ì´ìƒ</option>
                </select>
            </div>
            
            <button class="clear-filters" onclick="clearAllFilters()">í•„í„° ì´ˆê¸°í™”</button>
        </div>
    </div>

    <!-- ê²°ê³¼ ì •ë³´ -->
    <div class="results-info" id="resultsInfo"></div>

    <!-- ë¡œë”© í‘œì‹œ -->
    <div class="loading" id="loadingSpinner">
        <div class="spinner"></div>
        <div>ê²€ìƒ‰ ì¤‘...</div>
    </div>

    <div id="map"></div>

    <div id="restaurantList" class="card-container">
        <!-- ë§›ì§‘ ì¹´ë“œê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
    </div>

    <div id="noRestaurantMessage" class="no-restaurant" style="display: none;">
        ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” ë§›ì§‘ì´ ì—†ìŠµë‹ˆë‹¤.
    </div>

    <!-- data.js íŒŒì¼ì„ ë¨¼ì € ë¡œë“œ -->
    <script src="data.js"></script>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let allRestaurants = [];
        let filteredRestaurants = [];
        let map;
        let markers = [];
        let customOverlays = [];
        let favorites = new Set(); // ì¦ê²¨ì°¾ê¸° ì €ì¥ìš©
        let mapInitialized = false; // ì§€ë„ ì´ˆê¸°í™” ìƒíƒœ í™•ì¸ìš©

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            // ë¨¼ì € ê¸°ë³¸ ì„¤ì •ì„ ì´ˆê¸°í™”
            initializeBasicSettings();
            loadFavorites();
            
            // Kakao ì§€ë„ API ë¡œë“œ í›„ ì§€ë„ ì´ˆê¸°í™”
            loadKakaoMapAPI();
        });

        function initializeBasicSettings() {
            const urlParams = new URLSearchParams(window.location.search);
            const selectedRegionQuery = urlParams.get('region');

            const regionTitleElement = document.getElementById('selectedRegion');
            if (selectedRegionQuery) {
                regionTitleElement.textContent = `ìˆ˜ì›ì‹œ ${selectedRegionQuery} ë§›ì§‘ ë¦¬ìŠ¤íŠ¸`;
            } else {
                regionTitleElement.textContent = `ì „ì²´ ìˆ˜ì› ë§›ì§‘ ë¦¬ìŠ¤íŠ¸`;
            }

            // ì„ íƒëœ ì§€ì—­ì— ë§ëŠ” ë§›ì§‘ í•„í„°ë§
            if (typeof restaurants !== 'undefined') {
                allRestaurants = restaurants.filter(r => {
                    return selectedRegionQuery ? r.region === `ìˆ˜ì›ì‹œ ${selectedRegionQuery}` : true;
                });

                filteredRestaurants = [...allRestaurants];
                
                // ì§€ë„ ì—†ì´ ë¨¼ì € ë ˆìŠ¤í† ë‘ ëª©ë¡ í‘œì‹œ
                displayRestaurants(filteredRestaurants);
                updateResultsInfo(filteredRestaurants.length, allRestaurants.length);
            }

            // ê²€ìƒ‰ì°½ ì—”í„°í‚¤ ì´ë²¤íŠ¸
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    searchRestaurants();
                }
            });
        }

        function loadKakaoMapAPI() {
            // ì´ë¯¸ kakaoê°€ ë¡œë“œë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ì§€ë„ ì´ˆê¸°í™”
            if (typeof kakao !== 'undefined' && kakao.maps) {
                initializeMap();
                return;
            }

            // ìŠ¤í¬ë¦½íŠ¸ ë™ì  ë¡œë“œ
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=d07c1fa3d1db87476adc4e47a13eecf0&libraries=services&autoload=false';
            
            script.onload = function() {
                // kakao.maps.loadë¥¼ ì‚¬ìš©í•˜ì—¬ ì™„ì „íˆ ë¡œë“œëœ í›„ ì´ˆê¸°í™”
                if (typeof kakao !== 'undefined' && kakao.maps) {
                    kakao.maps.load(function() {
                        initializeMap();
                        // ì§€ë„ê°€ ì´ˆê¸°í™”ëœ í›„ í˜„ì¬ í•„í„°ë§ëœ ë ˆìŠ¤í† ë‘ë“¤ì„ ë‹¤ì‹œ í‘œì‹œ
                        if (filteredRestaurants.length > 0) {
                            displayRestaurants(filteredRestaurants);
                        }
                    });
                } else {
                    handleMapLoadError();
                }
            };
            
            script.onerror = function() {
                console.error('Kakao ì§€ë„ API ë¡œë“œ ì‹¤íŒ¨');
                handleMapLoadError();
            };
            
            document.head.appendChild(script);
        }

        function initializeMap() {
            if (mapInitialized) return; // ì¤‘ë³µ ì´ˆê¸°í™” ë°©ì§€
            
            const mapContainer = document.getElementById('map');
            const mapOption = {
                center: new kakao.maps.LatLng(37.2636, 127.0286),
                level: 6
            };

            try {
                if (typeof kakao !== 'undefined' && kakao.maps) {
                    map = new kakao.maps.Map(mapContainer, mapOption);
                    mapInitialized = true;
                    console.log('ì§€ë„ ì´ˆê¸°í™” ì™„ë£Œ');
                } else {
                    throw new Error('Kakao Maps API not available');
                }
            } catch (error) {
                console.error('ì§€ë„ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
                handleMapLoadError();
            }
        }

        function handleMapLoadError() {
            const mapContainer = document.getElementById('map');
            mapContainer.innerHTML = `
                <div style="padding: 50px; text-align: center; color: #666; background: white; border-radius: 8px;">
                    <p style="font-size: 1.2em; margin-bottom: 10px;">ğŸ—ºï¸ ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</p>
                    <p style="font-size: 0.9em; color: #999;">ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”</p>
                </div>
            `;
        }

        function searchRestaurants() {
            showLoading(true);
            
            setTimeout(() => {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
                
                if (!searchTerm) {
                    filteredRestaurants = [...allRestaurants];
                } else {
                    filteredRestaurants = allRestaurants.filter(restaurant => {
                        const nameMatch = restaurant.name.toLowerCase().includes(searchTerm);
                        const menuMatch = restaurant.menuItems && 
                            restaurant.menuItems.some(menu => menu.toLowerCase().includes(searchTerm));
                        const descMatch = restaurant.desc.toLowerCase().includes(searchTerm);
                        
                        return nameMatch || menuMatch || descMatch;
                    });
                }
                
                applyFilters();
                showLoading(false);
            }, 500);
        }

        function applyFilters() {
            const foodType = document.getElementById('foodTypeFilter').value;
            const minRating = document.getElementById('ratingFilter').value;
            
            let filtered = [...filteredRestaurants];
            
            // ìŒì‹ ì¢…ë¥˜ í•„í„°
            if (foodType) {
                filtered = filtered.filter(restaurant => {
                    return restaurant.foodType === foodType;
                });
            }
            
            // í‰ì  í•„í„° (ì‹¤ì œ ë¦¬ë·° ë°ì´í„° ì‚¬ìš©)
            if (minRating) {
                filtered = filtered.filter(restaurant => {
                    const avgRating = getAverageRating(restaurant.id);
                    return avgRating >= parseFloat(minRating);
                });
            }
            
            displayRestaurants(filtered);
            updateResultsInfo(filtered.length, allRestaurants.length);
        }

        function clearAllFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('foodTypeFilter').value = '';
            document.getElementById('ratingFilter').value = '';
            
            filteredRestaurants = [...allRestaurants];
            displayRestaurants(filteredRestaurants);
            updateResultsInfo(filteredRestaurants.length, allRestaurants.length);
        }

        function displayRestaurants(restaurants) {
            clearMapMarkers();
            
            const restaurantListElement = document.getElementById("restaurantList");
            const noRestaurantMessageElement = document.getElementById("noRestaurantMessage");
            
            restaurantListElement.innerHTML = '';
            
            if (restaurants.length === 0) {
                noRestaurantMessageElement.style.display = 'block';
                return;
            }
            
            noRestaurantMessageElement.style.display = 'none';
            
            // ì§€ë„ê°€ ì´ˆê¸°í™”ë˜ì–´ ìˆê³  ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ìš°ì—ë§Œ ì§€ë„ ê´€ë ¨ ì‘ì—… ìˆ˜í–‰
            let bounds = null;
            if (mapInitialized && map && typeof kakao !== 'undefined' && kakao.maps) {
                bounds = new kakao.maps.LatLngBounds();
            }
            
            restaurants.forEach(r => {
                // ì¹´ë“œ ìƒì„±
                const avgRating = getAverageRating(r.id);
                const reviewCount = getReviewCount(r.id);
                const menuSummary = r.menuItems && r.menuItems.length > 0
                    ? r.menuItems.slice(0, 2).join(', ') + (r.menuItems.length > 2 ? ' ë“±' : '')
                    : 'ë©”ë‰´ ì •ë³´ ì—†ìŒ';

                const div = document.createElement("div");
                div.className = "card";
                div.innerHTML = `
                    <h3>
                        <a href="detail.html?id=${r.id}">${r.name}</a>
                        <button class="favorite-btn ${favorites.has(r.id) ? 'active' : ''}" 
                                onclick="toggleFavorite('${r.id}')" 
                                aria-label="ì¦ê²¨ì°¾ê¸°">
                            ${favorites.has(r.id) ? 'â¤ï¸' : 'ğŸ¤'}
                        </button>
                    </h3>
                    <p><strong>ğŸ“ ì£¼ì†Œ:</strong> ${r.addr}</p>
                    <p><strong>ğŸ´ ëŒ€í‘œ ë©”ë‰´:</strong></p>
                    <p class="menu-summary">${menuSummary}</p>
                    <div class="card-rating">
                        <span class="stars">${generateStars(avgRating)}</span>
                        <span>${avgRating > 0 ? avgRating.toFixed(1) + 'ì ' : 'í‰ì  ì—†ìŒ'} (ë¦¬ë·° ${reviewCount}ê°œ)</span>
                    </div>
                    <p>${r.desc}</p>
                    ${r.foodType ? `<span class="food-type-tag">${r.foodType}</span>` : ''}
                `;
                restaurantListElement.appendChild(div);

                // ì§€ë„ ë§ˆì»¤ ì¶”ê°€ (ì§€ë„ê°€ ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ìš°ì—ë§Œ)
                if (mapInitialized && map && typeof kakao !== 'undefined' && kakao.maps) {
                    try {
                        const markerPosition = new kakao.maps.LatLng(r.lat, r.lng);
                        const marker = new kakao.maps.Marker({
                            position: markerPosition,
                            map: map,
                            title: r.name
                        });
                        markers.push(marker);
                        bounds.extend(markerPosition);

                        const customOverlayContent = `
                            <div class="label">
                                <span class="center">${r.name}</span>
                            </div>
                        `;

                        const customOverlay = new kakao.maps.CustomOverlay({
                            position: markerPosition,
                            content: customOverlayContent,
                            map: map,
                            yAnchor: 0.9
                        });
                        customOverlays.push(customOverlay);
                    } catch (error) {
                        console.error('ë§ˆì»¤ ìƒì„± ì˜¤ë¥˜:', error);
                    }
                }
            });

            // ì§€ë„ ë²”ìœ„ ì„¤ì • (ì§€ë„ê°€ ì‚¬ìš© ê°€ëŠ¥í•˜ê³  ë ˆìŠ¤í† ë‘ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ)
            if (mapInitialized && map && bounds && restaurants.length > 0) {
                try {
                    map.setBounds(bounds);
                } catch (error) {
                    console.error('ì§€ë„ ë²”ìœ„ ì„¤ì • ì˜¤ë¥˜:', error);
                }
            }
        }

        function clearMapMarkers() {
            markers.forEach(marker => {
                try {
                    marker.setMap(null);
                } catch (error) {
                    console.error('ë§ˆì»¤ ì œê±° ì˜¤ë¥˜:', error);
                }
            });
            customOverlays.forEach(overlay => {
                try {
                    overlay.setMap(null);
                } catch (error) {
                    console.error('ì˜¤ë²„ë ˆì´ ì œê±° ì˜¤ë¥˜:', error);
                }
            });
            markers = [];
            customOverlays = [];
        }

        function generateStars(rating) {
            if (rating === 0) return 'â˜†â˜†â˜†â˜†â˜†';
            
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            let stars = '';
            
            for (let i = 0; i < fullStars; i++) {
                stars += 'â˜…';
            }
            if (hasHalfStar) {
                stars += 'â˜†';
            }
            while (stars.length < 5) {
                stars += 'â˜†';
            }
            
            return stars;
        }

        // ì‹¤ì œ localStorageì—ì„œ ë¦¬ë·° ë°ì´í„°ë¥¼ ì½ì–´ì™€ì„œ í‰ê·  ë³„ì  ê³„ì‚°
        function getAverageRating(restaurantId) {
            try {
                const reviews = JSON.parse(localStorage.getItem(`reviews_${restaurantId}`)) || [];
                if (reviews.length === 0) return 0;
                
                const sum = reviews.reduce((total, review) => total + review.rating, 0);
                return sum / reviews.length;
            } catch (e) {
                console.error('ë¦¬ë·° ë¡œë“œ ì‹¤íŒ¨:', e);
                return 0;
            }
        }

        // ì‹¤ì œ localStorageì—ì„œ ë¦¬ë·° ê°œìˆ˜ë¥¼ ê°€ì ¸ì˜¤ê¸°
        function getReviewCount(restaurantId) {
            try {
                const reviews = JSON.parse(localStorage.getItem(`reviews_${restaurantId}`)) || [];
                return reviews.length;
            } catch (e) {
                console.error('ë¦¬ë·° ê°œìˆ˜ ë¡œë“œ ì‹¤íŒ¨:', e);
                return 0;
            }
        }

        function toggleFavorite(restaurantId) {
            if (favorites.has(restaurantId)) {
                favorites.delete(restaurantId);
            } else {
                favorites.add(restaurantId);
            }
            
            saveFavorites();
            
            // ë²„íŠ¼ ì—…ë°ì´íŠ¸
            const btn = event.target;
            if (favorites.has(restaurantId)) {
                btn.innerHTML = 'â¤ï¸';
                btn.classList.add('active');
            } else {
                btn.innerHTML = 'ğŸ¤';
                btn.classList.remove('active');
            }
            
            // ê°„ë‹¨í•œ í”¼ë“œë°±
            showToast(favorites.has(restaurantId) ? 'ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!' : 'ì¦ê²¨ì°¾ê¸°ì—ì„œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        function loadFavorites() {
            try {
                const saved = JSON.parse(localStorage.getItem('restaurantFavorites') || '[]');
                favorites = new Set(saved);
            } catch (e) {
                console.error('ì¦ê²¨ì°¾ê¸° ë¡œë“œ ì‹¤íŒ¨:', e);
                favorites = new Set();
            }
        }

        function saveFavorites() {
            try {
                localStorage.setItem('restaurantFavorites', JSON.stringify([...favorites]));
            } catch (e) {
                console.error('ì¦ê²¨ì°¾ê¸° ì €ì¥ ì‹¤íŒ¨:', e);
            }
        }

        function showLoading(show) {
            const spinner = document.getElementById('loadingSpinner');
            const restaurantList = document.getElementById('restaurantList');
            
            if (show) {
                spinner.style.display = 'block';
                restaurantList.style.opacity = '0.5';
            } else {
                spinner.style.display = 'none';
                restaurantList.style.opacity = '1';
            }
        }

        function updateResultsInfo(filtered, total) {
            const info = document.getElementById('resultsInfo');
            if (filtered === total) {
                info.textContent = `ì´ ${total}ê°œì˜ ë§›ì§‘ì´ ìˆìŠµë‹ˆë‹¤.`;
            } else {
                info.textContent = `${total}ê°œ ì¤‘ ${filtered}ê°œì˜ ë§›ì§‘ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.`;
            }
        }

        function showToast(message) {
            // ê°„ë‹¨í•œ í† ìŠ¤íŠ¸ ë©”ì‹œì§€
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #333;
                color: white;
                padding: 12px 20px;
                border-radius: 5px;
                z-index: 1000;
                animation: slideIn 0.3s ease;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    </script>
</body>
</html>
